# メール自動送信アプリ 実装指示プロンプト

このプロンプトを新しいリポジトリでAIに渡すと、これまでの設計を反映した実装が開始されます。

---

## 🚀 プロジェクト概要
Rust (egui) と Google Apps Script (GAS) を連携させた、高機能なメール自動送信デスクトップアプリを構築してください。

## 🛠 技術スタック
- **Frontend**: Rust + egui (eframe)
- **Backend**: Google Apps Script (GAS)
- **DataStore**: Googleスプレッドシート

## 📋 主要要件
1. **複数宛先・個別文面対応**:
   - 最大3名までの宛先を指定可能。
   - 宛先ごとに個別の本文を編集・送信できるようにする。
2. **宛先マスタ連携**:
   - スプレッドシートの「宛先リスト」に登録された顧客（会社名・氏名・メールアドレス）をアプリから選択可能にする。
   - 宛先選択時、あらかじめ紐づけられた「テンプレート（件名・本文）」を自動で入力欄に呼び出す。
3. **署名自動挿入**:
   - スプレッドシートの「設定」シートに登録した署名文を、本文末尾に自動挿入する。
4. **PDF OCR宛先抽出 (Phase 2対応想定)**:
   - PDFファイルをドロップした際、GAS（Cloud Vision等）経由で解析し、メールアドレスを抽出・自動セットする拡張性を持たせる。
5. **GUI構成 (タブ & 3カラム)**:
   - **送信タブ**: [左: 宛先選択] [中: 内容編集] [右: 添付・送信] の3カラム。
   - **設定タブ**: GAS URLの設定、接続テスト、署名・テンプレートのアプリ内プレビュー編集。

## 📂 ファイル構成案
- `src/main.rs`: エントリーポイント
- `src/app.rs`: アプリ状態・タブ管理
- `src/models.rs`: データ構造 (MailDraft, RecipientInfo, Template等)
- `src/api.rs`: GAS HTTP通信
- `src/ui/`: タブごとのUIモジュール化
- `gas/Code.gs`: GAS側のロジック (メール送信、SS操作、OCR用口)

## 🏁 最初のステップ
まずはプロジェクトの雛形（Cargo.toml と各ソースファイルの骨組み）を作成し、GAS側の `doGet` / `doPost` の基本形を実装してください。
詳細は、ディレクトリ内にある `PROMPT_設計書.md` と `開発プラン.md` を読み込んで遵守してください。
