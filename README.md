# Auto Mail Pilot

## Phase 2 Features ✅ (Completed)

Phase 2 では以下の高度な機能を実装しました：

- **動的宛先データ取得**: Google Sheets「宛先リスト」から自動同期
- **変数置換機能**: `{{name}}`, `{{company}}`, `{{email}}`, `{{id}}` の自動置換
- **複数宛先同時送信**: 最大3名までタブ形式で個別編集・一括送信
- **署名管理**: 「署名」シートから取得し、送信時に自動挿入
- **宛先-テンプレート紐付け**: 「紐付けマスター」に基づく自動テンプレート適用
- **完全日本語化**: 全UIコンポーネントの日本語翻訳
- **日本語フォント対応**: MS ゴシックの自動ロード

詳細な使い方は [Phase 2 Walkthrough](./brain/e601e159-403f-41d3-bba4-472f54571e11/phase2_walkthrough.md) をご覧ください。

---

## Post-Mortem

開発中に遭遇した課題と解決策は [Post-Mortem](./brain/e601e159-403f-41d3-bba4-472f54571e11/post_mortem.md) をご覧ください。

Rust (egui) と Google Apps Script (GAS) を連携させたメール自動送信アプリケーションです。

## 🚀 クイックスタート

### 1. 前提条件の確認
以下のツールがインストールされている必要があります。
- **Rust**: `cargo --version`
- **Node.js**: `node -v` (GASのデプロイツール `clasp` に必要です)

### 2. GAS (バックエンド) のセットアップ (clasp使用)

自動化ツール `clasp` を使ってデプロイします。

#### 手順
1. **clasp のインストール**:
   ```bash
   npm install -g @google/clasp
   ```

2. **Googleログイン**:
   ブラウザが開き、認証を求められます。
   ```bash
   clasp login
   ```

3. **プロジェクトの作成**:
   `gas` ディレクトリに移動し、新規プロジェクトを作成します（スプレッドシート付き）。
   ```bash
   cd gas
   clasp create --type sheets --title "Auto Mail Pilot DB"
   ```
   ※ ここで「既存のファイル上書き」警告が出るかもしれませんが、リポジトリ内の `Code.gs` を使うので問題ありません。

4. **コードのアップロード**:
   ```bash
   clasp push
   ```

5. **ウェブアプリとしてデプロイ**:
   ```bash
   clasp deploy --description "Initial Deploy"
   ```
   **重要**: `clasp deploy` だけでは「ウェブアプリ」としての公開設定（全員アクセス可能など）が完了しない場合があります。
   出力されたURLにアクセスして動作しない場合は、以下の手順でWebブラウザから設定を確認してください：
   1. `clasp open` でブラウザを開く
   2. [デプロイ] > [デプロイを管理] (または新規デプロイ)
   3. **アクセスできるユーザー** を **「全員 (Anyone)」** に設定

### 3. アプリの起動

ルートディレクトリ（`Cargo.toml` がある場所）に戻り、アプリを起動します。

```bash
cd ..
cargo run
```

### 4. アプリ設定
1. アプリの **Settings** タブを開きます。
2. デプロイしたGASの **ウェブアプリURL** を入力します。
   （`clasp open --webapp` などで確認、あるいは手動デプロイ時のURL）
3. **Test Connection** を押して接続確認します。

## 🐞 トラブルシューティング

- **日本語フォントが豆腐になる**: Windowsのデフォルトフォントを使用していますが、表示されない場合はシステムフォントの設定を確認してください。
- **GASエラー**: `clasp push` 時に `.claspignore` がないと余計なファイルがアップロードされることがあります。
- **CORSエラー**: Webアプリのアクセス権限が「自分のみ」になっていると外部から叩けません。「全員」に設定してください。
